
๐๏ธ ุงููููููุฉ ุงูููุชุฑุญุฉ (ุจุฏูู ุชุบููุฑ ุงููุฌูุฏุงุช)
ูู ููุดุฆ ูุฌูุฏุงุช ุฌุฏูุฏุฉุ ุณูุณุชุฎุฏู ุงููุฌูุฏุงุช ุงูุญุงููุฉ ุจุฐูุงุก:

hooks: ุณูุถูู ูููุงุช ููุชุญูู ูู ุงูููุทู (History, AutoSave).
utils: ุณูุถูู ูููุงุช ูููุนุงูุฌุฉ "ุงูุซูููุฉ" (PDF Generation, Formatting).
๐ ุงูุฎุทุฉ ุงูุชูุตูููุฉ ููู ุฏุงูุฉ
1๏ธโฃ ุฏุงูุฉ handleHistory (Undo/Redo)
ุจุฏูุงู ูู ุงูุงุนุชูุงุฏ ุนูู document.execCommand (ุงูุชู ูุฏ ุชููู ุบูุฑ ูุณุชูุฑุฉ ูุน React)ุ ุณูุจูู Hook ูุฎุตุต ูุฅุฏุงุฑุฉ ุณุฌู ุงูุชุบููุฑุงุช.

ุงูููุงู ุงูููุชุฑุญ: ููู ุฌุฏูุฏ src/hooks/use-history.ts
ุงูุณุจุจ: ููุทู ุงูู Undo/Redo ูุนูุฏ ููุญุชุงุฌ ูู State ูููุตูุ ุนุฒูู ูู Hook ูุฌุนูู ูุงุจูุงู ููุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู ูุงูุงุฎุชุจุงุฑ.
ุฎุทูุงุช ุงูุชูููุฐ:

ุฅูุดุงุก useHistory ูุณุชุฎุฏู ูุตูููุชูู: past (ุงููุงุถู) ู future (ุงููุณุชูุจู).
ุฑุจุท ูุฐุง ุงูู Hook ูุน ุญุงูุฉ ุงููุญุชูู ูู ScreenplayEditor.
ุชุนุฏูู handleHistory ููุชุญ ูุงุฆูุฉ (Dropdown) ุชุนุฑุถ ุขุฎุฑ ุงูุชุนุฏููุงุช (ุงุฎุชูุงุฑู) ุฃู ููุท ุชูููุฐ undo/redo.
2๏ธโฃ ุฏุงูุฉ handleSave (Hifz / Persistence)
ููุฅูุชุงุฌุ ุงูุญูุธ ูุฌุจ ุฃู ูููู ุนูู ูุณุชูููู:

ุญูุธ ุชููุงุฆู (Auto-save): ูู localStorage ูุถูุงู ุนุฏู ุถูุงุน ุงูุจูุงูุงุช ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ.
ุญูุธ ูุฏูู (Manual Save): ุญูุธ ููู .json ุฃู .fountain ุนูู ุฌูุงุฒ ุงููุณุชุฎุฏู ููุชููู ูู ุงุณุชุนุงุฏุชู ูุงุญูุงู.
ุงูููุงู ุงูููุชุฑุญ: ููู ุฌุฏูุฏ src/hooks/use-local-storage.ts (ููุญูุธ ุงูุชููุงุฆู) ูุฏุงูุฉ ูู src/utils/file-operations.ts (ููุญูุธ ุงููุฏูู).
ุฎุทูุงุช ุงูุชูููุฐ:

ุฅูุดุงุก Hook ูููู ุจูุฑุงูุจุฉ ุงูุชุบููุฑุงุช ูู ุงููุญุชูู ูุญูุธูุง ูู LocalStorage ูู ุจุถุน ุซูุงูู (Debounced).
ุชุนุฏูู ุฒุฑ "ุญูุธ" ููููู ุจุชูุฒูู ููู ูุญุชูู ุนูู ูุญุชูู ุงูุณููุงุฑูู ูุจูุงูุงุชู ุงููุตููุฉ.
3๏ธโฃ ุฏุงูุฉ handleDownload (PDF / Export)
ูุฐู ุงูุฏุงูุฉ ุชุชุทูุจ ูุนุงูุฌุฉ ุซูููุฉ ูุชุญููู HTML ุฅูู PDF ุฃู ูุต ููุณู. ูุง ูุฌุจ ุฃู ูููู ูุฐุง ุงูููุฏ ูู ููู ุงููุงุฌูุฉ.

ุงูููุงู ุงูููุชุฑุญ: ููู ุฌุฏูุฏ src/utils/exporters.ts
ุงูุณุจุจ: ุนูููุงุช ุงูุชุญููู (Export Logic) ูู ุนูููุงุช ูุณุงุนุฏุฉ ุจุญุชุฉ (Pure Functions).
ุฎุทูุงุช ุงูุชูููุฐ:

ุชุซุจูุช ููุชุจุฉ ุฎูููุฉ ูุซู html2pdf.js ุฃู ุงุณุชุฎุฏุงู window.print ุจุณุชุงูู ูุฎุตุต ููุทุจุงุนุฉ.
ุฅูุดุงุก ุฏุงูุฉ exportToPDF ูุฏุงูุฉ exportToFountain.
ุงุณุชุฏุนุงุก ูุฐู ุงูุฏูุงู ุฏุงุฎู handleDownload.
๐ ููุฎุต ุงููููุงุช ุงูุฌุฏูุฏุฉ (Blueprint)
ุฅููู ููู ุณุชุจุฏู ุงููููุงุช ุงูุชู ุณุฃูุดุฆูุง ูู:

1. src/hooks/use-history.ts
import { useState, useCallback } from 'react';

export function useHistory<T>(initialState: T) {
  const [index, setIndex] = useState(0);
  const [history, setHistory] = useState([initialState]);

  const setState = (action: T | ((prev: T) => T)) => {
    // ููุทู ุฅุถุงูุฉ ุญุงูุฉ ุฌุฏูุฏุฉ ููุณุฌู ูุฅุฒุงูุฉ "ุงููุณุชูุจู" ุงููุฏูู
  };

  const undo = () => { /* ุงูุฑุฌูุน ุฎุทูุฉ ููุฎูู */ };
  const redo = () => { /* ุงูุชูุฏู ุฎุทูุฉ ููุฃูุงู */ };

  return { state: history[index], set: setState, undo, redo, canUndo, canRedo };
}
2. src/utils/exporters.ts
import { screenplayFormats } from '@/constants';

export const exportToFountain = (htmlContent: string): string => {
  // ููุทู ุชุญููู HTML ุฅูู ูุต Fountain
  // ูุซุงู: <div class="character">AHMED</div> -> AHMED
};

export const downloadFile = (content: string, filename: string, type: 'pdf' | 'text') => {
  // ููุทู ุฅูุดุงุก Blob ูุฑุงุจุท ุงูุชุญููู
};